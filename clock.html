<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily Activity Tracker</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #000080;
            margin: 0;
            padding: 40px 40px 40px 80px; /* Added left padding */
            color: white;
        }

        h1 {
            text-align: center;
            color: #fff;
        }

        label {
            font-weight: bold;
            margin-right: 10px;
            color: #fff;
        }

        input, select, button {
            padding: 10px;
            margin: 5px 0;
            border-radius: 5px;
            border: 1px solid #ccc;
            color: #000;
        }

        button {
            background-color: #007bff;
            color: white;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        button:hover {
            background-color: #0056b3;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background-color: #333;
            color: white;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.1);
        }

        th, td {
            border: 1px solid #555;
            padding: 10px;
            text-align: center;
        }

        th {
            background-color: #007bff;
            color: white;
        }

        td input {
            width: 90%;
            padding: 8px;
            border-radius: 5px;
            border: 1px solid #ccc;
            color: #000;
        }

        .digital-clock {
            width: 300px;
            padding: 20px;
            text-align: center;
            margin: 20px auto;
            background-color: #000;
            border: 4px solid #444;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.5);
            font-family: 'Digital', sans-serif;
        }

        .digital-clock .date {
            font-size: 18px;
            color: #0f0;
            margin-bottom: 10px;
        }

        .digital-clock .time {
            font-size: 48px;
            color: #0f0;
            text-shadow: 0 0 10px rgba(0, 255, 0, 0.7);
        }

        .zoom-controls {
            position: fixed;
            top: 10px;
            right: 10px;
            z-index: 1000;
        }

        .zoom-btn {
            padding: 5px 10px;
            margin: 0 5px;
            font-size: 16px;
            cursor: pointer;
        }

        @font-face {
            font-family: 'Digital';
            src: url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap');
        }
    </style>
</head>
<body>
    <div class="zoom-controls">
        <button class="zoom-btn" onclick="adjustZoom(1.1)">+</button>
        <button class="zoom-btn" onclick="adjustZoom(0.9)">-</button>
    </div>

    <h1>TIME TRACKER</h1>
    <div class="digital-clock" id="digital-clock">
        <div class="date"></div>
        <div class="time"></div>
    </div>

    <label for="email">Enter Your Email Address: </label>
    <input type="email" id="email" placeholder="Your email address">
    <button onclick="saveEmail()">Save Email</button>
    <br>
    <label for="sleep-from">Sleep From: </label>
    <select id="sleep-from">
        <!-- Options will be populated by JavaScript -->
    </select>
    <label for="sleep-to">To: </label>
    <select id="sleep-to">
        <!-- Options will be populated by JavaScript -->
    </select>
    <button onclick="saveSleepTime()">Save Sleep Time</button>
    <br>
    <table>
        <thead>
            <tr>
                <th>Time</th>
                <th>Activity</th>
            </tr>
        </thead>
        <tbody id="activity-table">
            <!-- Rows will be generated by JavaScript -->
        </tbody>
    </table>

    <script>
        const hours = [
            "6:00 AM - 7:00 AM", "7:00 AM - 8:00 AM", "8:00 AM - 9:00 AM", "9:00 AM - 10:00 AM",
            "10:00 AM - 11:00 AM", "11:00 AM - 12:00 PM", "12:00 PM - 1:00 PM", "1:00 PM - 2:00 PM",
            "2:00 PM - 3:00 PM", "3:00 PM - 4:00 PM", "4:00 PM - 5:00 PM", "5:00 PM - 6:00 PM",
            "6:00 PM - 7:00 PM", "7:00 PM - 8:00 PM", "8:00 PM - 9:00 PM", "9:00 PM - 10:00 PM",
            "10:00 PM - 11:00 PM", "11:00 PM - 12:00 AM", "12:00 AM - 1:00 AM", "1:00 AM - 2:00 AM",
            "2:00 AM - 3:00 AM", "3:00 AM - 4:00 AM", "4:00 AM - 5:00 AM", "5:00 AM - 6:00 AM"
        ];

        let currentUserEmail = "";
        let currentZoom = 1;

        function adjustZoom(factor) {
            currentZoom *= factor;
            document.body.style.zoom = currentZoom;
            document.body.style.cssText += '; -moz-transform: scale(' + currentZoom + '); -moz-transform-origin: 0 0;';
            localStorage.setItem("lastZoom", currentZoom);
        }

        function saveEmail() {
            const email = document.getElementById("email").value;
            if (email.trim() === "") {
                alert("Please enter your email address.");
                return;
            }
            currentUserEmail = email;
            localStorage.setItem("currentUserEmail", email);
            loadSleepTime();
            renderTable();
        }

        function getStorageKey(key) {
            return `${currentUserEmail}_${key}`;
        }

        function loadSleepTime() {
            if (currentUserEmail === "") return;
            const sleepTime = JSON.parse(localStorage.getItem(getStorageKey("sleepTime")));
            if (sleepTime) {
                document.getElementById("sleep-from").value = sleepTime.from;
                document.getElementById("sleep-to").value = sleepTime.to;
            }
        }

        function saveSleepTime() {
            if (currentUserEmail === "") {
                alert("Please enter and save your email address first.");
                return;
            }
            const sleepFrom = document.getElementById("sleep-from").value;
            const sleepTo = document.getElementById("sleep-to").value;
            localStorage.setItem(getStorageKey("sleepTime"), JSON.stringify({ from: sleepFrom, to: sleepTo }));
            renderTable();
        }

        function saveActivity(hour) {
            if (currentUserEmail === "") {
                alert("Please enter and save your email address first.");
                return;
            }
            const activity = document.getElementById(`activity_${hour}`).value;
            localStorage.setItem(getStorageKey(`activity_${hour}`), activity);
        }

        function loadActivities() {
            const activities = {};
            if (currentUserEmail === "") return activities;
            for (let i = 0; i < hours.length; i++) {
                const activity = localStorage.getItem(getStorageKey(`activity_${i}`));
                activities[i] = activity || "";
            }
            return activities;
        }

        function renderTable() {
            const sleepTime = JSON.parse(localStorage.getItem(getStorageKey("sleepTime")));
            const activityTable = document.getElementById("activity-table");
            activityTable.innerHTML = "";

            const sleepFrom = sleepTime ? parseTime(sleepTime.from) : null;
            const sleepTo = sleepTime ? parseTime(sleepTime.to) : null;

            const activities = loadActivities();

            for (let i = 0; i < hours.length; i++) {
                if (isInSleepTime(i, sleepFrom, sleepTo)) {
                    continue;
                }

                const row = document.createElement("tr");
                const timeCell = document.createElement("td");
                const activityCell = document.createElement("td");

                timeCell.textContent = hours[i];

                const activityInput = document.createElement("input");
                activityInput.type = "text";
                activityInput.id = `activity_${i}`;
                activityInput.value = activities[i];
                activityInput.onchange = () => saveActivity(i);

                activityCell.appendChild(activityInput);

                row.appendChild(timeCell);
                row.appendChild(activityCell);
                activityTable.appendChild(row);
            }
        }

        function parseTime(timeStr) {
            const [time, period] = timeStr.split(" ");
            let [hours, minutes] = time.split(":").map(Number);
            if (period.toUpperCase() === "PM" && hours !== 12) {
                hours += 12;
            } else if (period.toUpperCase() === "AM" && hours === 12) {
                hours = 0;
            }
            return hours * 60 + minutes;
        }

        function isInSleepTime(hourIndex, sleepFrom, sleepTo) {
            if (sleepFrom === null || sleepTo === null) {
                return false;
            }
            const start = parseTime(hours[hourIndex].split(" - ")[0]);
            const end = parseTime(hours[hourIndex].split(" - ")[1]);
            if (sleepFrom < sleepTo) {
                return start >= sleepFrom && end <= sleepTo;
            } else {
                return start >= sleepFrom || end <= sleepTo;
            }
        }

        function populateTimeOptions() {
            const times = [
                "12:00 AM", "1:00 AM", "2:00 AM", "3:00 AM", "4:00 AM", "5:00 AM", "6:00 AM",
                "7:00 AM", "8:00 AM", "9:00 AM", "10:00 AM", "11:00 AM", "12:00 PM",
                "1:00 PM", "2:00 PM", "3:00 PM", "4:00 PM", "5:00 PM", "6:00 PM",
                "7:00 PM", "8:00 PM", "9:00 PM", "10:00 PM", "11:00 PM"
            ];

            const sleepFromSelect = document.getElementById("sleep-from");
            const sleepToSelect = document.getElementById("sleep-to");

            times.forEach(time => {
                const optionFrom = document.createElement("option");
                optionFrom.value = time;
                optionFrom.text = time;
                sleepFromSelect.appendChild(optionFrom);

                const optionTo = document.createElement("option");
                optionTo.value = time;
                optionTo.text = time;
                sleepToSelect.appendChild(optionTo);
            });
        }

        function updateClock() {
            const now = new Date();
            const date = now.toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
            const time = now.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: true });

            const clockElement = document.getElementById("digital-clock");
            if (clockElement) {
                clockElement.querySelector('.date').textContent = date;
                clockElement.querySelector('.time').textContent = time;
            }
        }

        document.addEventListener("DOMContentLoaded", () => {
            populateTimeOptions();
            const storedEmail = localStorage.getItem("currentUserEmail");
            if (storedEmail) {
                currentUserEmail = storedEmail;
                document.getElementById("email").value = currentUserEmail;
                loadSleepTime();
                renderTable();
            }
            updateClock();
            setInterval(updateClock, 1000);

            // Load and apply the last zoom level
            const lastZoom = parseFloat(localStorage.getItem("lastZoom"));
            if (!isNaN(lastZoom)) {
                currentZoom = lastZoom;
                document.body.style.zoom = currentZoom;
                document.body.style.cssText += '; -moz-transform: scale(' + currentZoom + '); -moz-transform-origin: 0 0;';
            }
        });

        // Save zoom level before unloading the page
        window.addEventListener("beforeunload", () => {
            localStorage.setItem("lastZoom", currentZoom);
        });
    </script>
</body>
</html>
